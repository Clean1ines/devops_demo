apiVersion: apps/v1
kind: StatefulSet
metadata:
name: postgres
spec:
serviceName: postgres
replicas: 1
selector:
matchLabels:
app: postgres
template:
metadata:
labels:
app: postgres
spec:
containers:
- name: postgres
image: postgres:15-alpine
env:
- name: POSTGRES_PASSWORD
value: "postgres"
- name: POSTGRES_DB
value: "neolant_db"
ports:
- containerPort: 5432
volumeMounts:
- name: postgres-data
mountPath: /var/lib/postgresql/data
volumeClaimTemplates:

· metadata:
  name: postgres-data
  spec:
  accessModes: [ "ReadWriteOnce" ]
  resources:
  requests:
  storage: 10Gi

---

apiVersion: v1
kind: Service
metadata:
name: postgres
spec:
ports:

· port: 5432
  selector:
  app: postgres
  clusterIP: None
  EOF

cat > k8s/dotnet-deployment.yaml << 'EOF'
apiVersion: apps/v1
kind: Deployment
metadata:
name: dotnet-api
spec:
replicas: 2
selector:
matchLabels:
app: dotnet-api
template:
metadata:
labels:
app: dotnet-api
spec:
containers:
- name: dotnet-api
image: neolant/dotnet-api:latest
ports:
- containerPort: 8080
env:
- name: ASPNETCORE_ENVIRONMENT
value: "Production"

---

apiVersion: v1
kind: Service
metadata:
name: dotnet-api
spec:
type: ClusterIP
ports:

· port: 80
  targetPort: 8080
  selector:
  app: dotnet-api
  EOF

cat > helm/Chart.yaml << 'EOF'
apiVersion: v2
name: neolant
description: Neolant Industrial Platform
version: 1.0.0
